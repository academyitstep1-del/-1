import os
import requests

API_KEY = os.getenv("ELEVENLABS_API_KEY")  # встанови у .env або вручну
VOICE_ID = "JBFqnCBsd6RMkjVDRZzb"  # приклад голосу
MODEL_ID = "eleven_multilingual_v2"  # модель TTS :contentReference[oaicite:2]{index=2}

def text_to_speech(text: str, output_path: str = "output.mp3"):
    url = "https://api.elevenlabs.io/v1/text-to-speech"  # перевір актуальний endpoint
    headers = {
        "xi-api-key": API_KEY,
        "Content-Type": "application/json",
    }
    payload = {
        "text": text,
        "voice_id": VOICE_ID,
        "model_id": MODEL_ID,
        "output_format": "mp3_44100_128"
    }
    resp = requests.post(url, json=payload, headers=headers)
    resp.raise_for_status()
    # response містить байти аудіо
    with open(output_path, "wb") as f:
        f.write(resp.content)
    print(f"Audio saved to {output_path}")

if __name__ == "__main__":
    sample_text = "Привіт! Це тест озвучки за допомогою ElevenLabs API."
    text_to_speech(sample_text, "hello.mp3")
